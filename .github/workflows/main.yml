# This is a basic workflow to help you get started with Actions

name: Deploy

# Controls when the workflow will run
on: [push, pull_request, workflow_dispatch]

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  # This workflow contains a single job called "build-and-deploy"
  build-and-deploy:
    # The type of runner that the job will run on
    runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
    steps:
      # Checks-out CDK Repository
      - uses: actions/checkout@v2
        with: 
          repository: sagardsaxena/StocksCDK
          path: ./StocksCDK

      # Checks-out ReactApp Repository
      - uses: actions/checkout@v2
        with: 
          repository: sagardsaxena/StocksReactApp
          path: ./StocksReactApp

      # Install AWS cdk
      - name: Install cdk
        run: npm install -g aws-cdk

      # Install AWS cdk
      - name: Run aws command
        run: aws

      # Build CDK
      - name: Build CDK
        run: |
          cd StocksCDK
          npm install
          npm run build
          cd ..

      # Build React App
      - name: Build CDK
        run: |
          cd StocksReactApp
          npm install
          npm run build
          cd ..
          
